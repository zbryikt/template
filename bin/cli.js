#!/usr/bin/env node
// Generated by LiveScript 1.3.1
var t1, fs, path, lib, server, watch, api, cfgfile, main, config;
t1 = Date.now();
fs = require('fs');
path = require('path');
lib = path.dirname(fs.realpathSync(__filename));
server = require(lib + "/lib/server");
watch = require(lib + "/lib/watch");
api = require(lib + "/api/index");
if (/\.json$/.exec(process.argv[2] || '')) {
  cfgfile = process.argv[2];
}
if (!cfgfile) {
  cfgfile = 'config.json';
}
main = {
  opt: {
    api: api,
    startTime: t1
  },
  setOpt: function(o){
    return import$(this.opt, o);
  },
  init: function(){
    server.init(this.opt);
    return watch.init(this.opt);
  }
};
if (require.main === module) {
  if (fs.existsSync(cfgfile)) {
    config = JSON.parse(fs.readFileSync(cfgfile).toString());
    main.setOpt(config);
  }
  main.init();
}
module.exports = main;
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
